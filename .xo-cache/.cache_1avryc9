{"/app/helpers.js":{"size":254,"mtime":1500328632955,"hashOfConfig":"hm2zq5","results":{"filePath":"/app/helpers.js","messages":[],"errorCount":0,"warningCount":0}},"/app/db-connect.js":{"size":1049,"mtime":1500331941043,"hashOfConfig":"hm2zq5","results":{"filePath":"/app/db-connect.js","messages":[],"errorCount":0,"warningCount":0,"output":"const mongo = require('mongodb').MongoClient\n\nconst mongoUri = process.env.MONGO_URI\n\nconst connect = (url, res) => {\n  mongo.connect(mongoUri, (err, db) => {\n    if (err) {\n      throw err\n    }\n\n    const collection = db.collection('urls')\n\n    collection.find({_id: 'url info'}).toArray((err, docs) => {\n      if (err) {\n        throw err\n      }\n\n      if (docs.length === 0) {\n        collection.insertMany([{_id: 'url info', numIds: 0}, {0: url}], err => {\n          if (err) {\n            throw err\n          }\n\n          const urlsToSend = {normal: url, shortened: 'https://nickel-value.glitch.me/0'}\n\n          db.close()\n          res.end(JSON.stringify(urlsToSend))\n        })\n      } else {\n        collection.update({_id: 'url info'}, {$inc: {numIds: 1}}, err => {\n          if (err) {\n            throw err\n          }\n\n          const urlId = docs[0].numIds + 1\n          const urlToSend = {normal: url, shortened: 'https://nickel-value.glitch.me/' + urlId}\n\n          db.close()\n          res.end(JSON.stringify(urlToSend))\n        })\n      }\n    })\n  })\n}\n\nmodule.exports = connect\n\n"}}}